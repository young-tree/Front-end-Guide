```html
<style>
  table {
    border-collapse: collapse;
  }

  th, td {
    border: 1px solid #aaa;
    padding: 12px 16px;
    text-align: center;
  }
</style>

<h1>购物车已清空~</h1>

<div>
  <table>
    <thead>
      <tr>
        <th>编号</th>
        <th>书籍名称</th>
        <th>出版日期</th>
        <th>价格</th>
        <th>购买数量</th>
        <th>操作</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <h2>总价格: ￥ <span></span></h2>
</div>

<script>
  // 数据
  var books = [
    {
      id: 1,
      name: '《算法导论》',
      date: '2006-09',
      price: 85.00,
      count: 3
    },
    {
      id: 2,
      name: '《UNIX编程艺术》',
      date: '2006-02',
      price: 59.00,
      count: 2
    },
    {
      id: 3,
      name: '《编程珠玑》',
      date: '2008-10',
      price: 39.00,
      count: 5
    },
    {
      id: 4,
      name: '《代码大全》',
      date: '2006-03',
      price: 128.00,
      count: 8
    }
  ]

  // 渲染数据
  const tableEl = document.querySelector("table")
  const tbodyEl = tableEl.tBodies[0];
  for (const book of books) {
    const trEl = document.createElement("tr");
    for (const key in book) {
      const tdEl = document.createElement("td");

      if (key === "count") {
        const button1 = document.createElement("button")
        button1.textContent = "-";
        tdEl.append(button1);
        const span = document.createElement("span")
        span.textContent = book[key];
        span.style.padding = "0 10px";
        tdEl.append(span);
        const button2 = document.createElement("button")
        button2.textContent = "+";
        tdEl.append(button2);

        // 监听减号和加号的点击事件
        button1.addEventListener("click", (event) => {
          console.log("123");

          // 1.更新数据, 更新span 
          span.textContent = --book[key];

          if(book[key] <= 1) {
            event.currentTarget.disabled = true;
          }

          // 2.重新计算价格
          calcTotalPrice();
        });
        button2.addEventListener("click", () => {
          if (button1.disabled) button1.disabled = false;

          // 1.更新数据, 更新span 
          span.textContent = ++book[key];

          // 2.重新计算价格
          calcTotalPrice();
        });
      } else if(key === "price") {
        tdEl.textContent = `￥${book[key]}`;
      } else {
        tdEl.textContent = book[key];
      }
      trEl.append(tdEl);
    }
    const button = document.createElement("button");
    button.textContent = "删除"
    const tdEl = document.createElement("td");
    tdEl.append(button);

    button.addEventListener("click", (event) => {
      // 删除1: 先删除掉数组中的书籍
      const ownerTrEl = event.currentTarget.parentElement.parentElement;
      console.log(ownerTrEl.sectionRowIndex);  // 这里比较重要
      books.splice(ownerTrEl.sectionRowIndex, 1);

      // 删除2: 后删除掉自己的tr
      ownerTrEl.remove();

      // 删除3: 重新计算总价格
      calcTotalPrice();

      // 判断购物车是否已被清空
      isCarClear();
    });

    trEl.append(tdEl);
    tbodyEl.append(trEl);
  }

  // 计算总价
  const h2El = document.querySelector("h2");
  const spanEl = h2El.querySelector("span");
  calcTotalPrice();

  function calcTotalPrice() {
    const totalPrice = books
    .reduce((preVal, item) => preVal + (item.price * item.count), 0);
    spanEl.textContent = totalPrice;
  }

  // 购物车已清空
  const h1El = document.querySelector("h1");
  const divEl = document.querySelector("div");
  isCarClear();
  function isCarClear() {
    console.log(books.length)
    if (books.length === 0) {
      h1El.hidden = false;
      divEl.hidden = true;
    } else {
      divEl.hidden = false;
      h1El.hidden = true;
    }
  } 
</script>
```

