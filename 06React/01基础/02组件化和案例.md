### 1.组件化

```jsx
<div id="root"></div>

<script src="./lib/react.js"></script>
<script src="./lib/react-dom.js"></script>
<script src="./lib/babel.js"></script>

<script type="text/babel">
  class App extends React.Component {
    constructor() {
      super()

      this.state = {
        message: "Hello World"
      }
    }

    changeMessage() {
      this.setState({ message: "你好, 世界" })
    }

    render() {
      return (
        <div>
          <h2>{this.state.message}</h2>
          <button onClick={this.changeMessage}>修改文本</button>
        </div>
      )
    }
  }

  const root = ReactDOM.createRoot(document.querySelector("#root"))
  root.render(<App/>)
</script>
```

- 请问：changeMessage中的this代表的是App这个组件实例吗？

  - 不是，这么写this是undefined
  - 因为onClick在回调changeMessage时，很有可能是默认调用，所以是undefined
  - 不应该是window吗？因为changeMessage是一个class中的方法，默认开启严格模式

- 修改代码，显示绑定当前组件实例

  ```jsx
  class App extends React.Component {
    constructor() {
      super()
  
      this.state = {
        message: "Hello World"
      }
    }
  
    changeMessage() {
      this.setState({ message: "你好, 世界" })
    }
  
    render() {
      return (
        <div>
          <h2>{this.state.message}</h2>
          <button onClick={this.changeMessage.bind(this)}>修改文本</button>
        </div>
      )
    }
  }
  ```

  - 这里要补充一点，setState来自哪里？来自父类，也就是来自React.Component
  - setState内部做了两件事情
    1. 将state中message的值修改掉
    2. 自动重新执行render函数

- 也可以这么写

  ```jsx
  class App extends React.Component {
    constructor() {
      super()
  
      this.state = {
        message: "Hello World"
      }
  
      this.changeMessage = this.changeMessage.bind(this)
    }
  
    changeMessage() {
      this.setState({ message: "你好, 世界" })
    }
  
    render() {
      return (
        <div>
          <h2>{this.state.message}</h2>
          <button onClick={this.changeMessage}>修改文本</button>
        </div>
      )
    }
  }
  ```


### 2.电影列表

```jsx
const root = ReactDOM.createRoot(document.querySelector("#root"))

class App extends React.Component {
  constructor() {
    super()

    this.state = {
      movies: ["隐入尘烟", "流浪地球", "阿凡达2", "壮志凌云"]
    }
  }

  render() {
    const liEls = []
    for(let i = 0; i < this.state.movies.length; i++) {
      const item = this.state.movies[i]
      liEls.push(<li key={item}>{item}</li>)
    }

    return (
      <div>
        <h2>电影列表</h2>
        <ul>
          { liEls }
          { this.state.movies.map(movie => <li key={movie}>{movie}</li>) }
        </ul>
      </div>
    )
  }
}

root.render(<App/>)
```

### 3.计数器

```jsx
const root = ReactDOM.createRoot(document.querySelector("#root"))

class App extends React.Component {
  constructor() {
    super()

    this.state = {
      counter: 0
    }
  }

  increment() {
    this.setState({ counter: this.state.counter + 1 })
  }
  decrement() {
    this.setState({ counter: this.state.counter - 1 })
  }

  render() {
    return (
      <div>
        <h2>当前计数: {this.state.counter}</h2>
        <button onClick={this.increment.bind(this)}>+1</button>
        <button onClick={this.decrement.bind(this)}>-1</button>
      </div>
    )
  }
}

root.render(<App/>)
```

